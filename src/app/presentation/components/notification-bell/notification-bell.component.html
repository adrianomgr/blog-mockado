<div class="notification-bell-container">
  <p-button
    icon="pi pi-bell"
    [severity]="notifications.length > 0 ? 'info' : 'secondary'"
    [outlined]="true"
    (onClick)="showNotifications = true"
    [pTooltip]="
      notifications.length > 0 ? notifications.length + ' notificações' : 'Nenhuma notificação'
    "
    tooltipPosition="bottom"
    [badge]="notifications.length > 0 ? notifications.length.toString() : undefined"
    badgeClass="p-badge-info"
  ></p-button>

  <p-dialog
    header="Notificações"
    [(visible)]="showNotifications"
    [modal]="true"
    [style]="{ width: '450px', maxHeight: '600px' }"
    [closable]="true"
    [draggable]="false"
    [resizable]="false"
  >
    <div class="notification-content">
      <div class="notification-list">
        @if (notifications.length === 0) {
        <div class="p-4 text-center text-color-secondary">
          <i class="pi pi-bell-slash text-4xl mb-3 block"></i>
          <p>Nenhuma notificação</p>
        </div>
        } @for (notification of notifications; track notification.id) {
        <div class="notification-item p-3 mb-2 border-1 surface-border border-round">
          <div class="flex align-items-start gap-3">
            <i
              [class]="notification.icon"
              [class.text-blue-500]="notification.type === 'new-post'"
              [class.text-green-500]="notification.type === 'new-user'"
              class="text-xl flex-shrink-0"
            ></i>

            <div class="flex-1">
              <div class="flex justify-content-between align-items-start">
                <h5 class="m-0 text-sm font-semibold">{{ notification.title }}</h5>
                <small class="text-color-secondary ml-2">{{
                  notification.timestamp | timeAgo
                }}</small>
              </div>
              <p class="m-0 mt-1 text-sm text-color-secondary">{{ notification.message }}</p>

              <div class="flex justify-content-between align-items-center mt-2">
                <span
                  class="text-xs px-2 py-1 border-radius-md"
                  [class.bg-blue-100]="notification.type === 'new-post'"
                  [class.text-blue-700]="notification.type === 'new-post'"
                  [class.bg-green-100]="notification.type === 'new-user'"
                  [class.text-green-700]="notification.type === 'new-user'"
                >
                  {{ notification.type === 'new-post' ? 'Novo Post' : 'Novo Usuário' }}
                </span>
              </div>
            </div>
          </div>
        </div>
        }
      </div>
    </div>
  </p-dialog>
</div>
